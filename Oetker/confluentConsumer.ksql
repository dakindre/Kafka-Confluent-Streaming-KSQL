CREATE STREAM USER (email VARCHAR, country VARCHAR) WITH (KAFKA_TOPIC='oetker', VALUE_FORMAT='JSON');
CREATE STREAM USER_INFO AS SELECT 1 AS const, email, country FROM USER;
CREATE TABLE UNIQUE_USERS AS SELECT COUNT(*) AS UNIQUE_USERS, const FROM USER_INFO WINDOW TUMBLING (size 3 seconds) GROUP BY const;
CREATE TABLE COUNTRY_AGG AS SELECT country, COUNT(*) as countryCount FROM USER GROUP BY country;
